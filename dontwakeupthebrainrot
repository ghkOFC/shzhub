-- Serviços
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- ===================== GUI =====================
local GHZhub = Instance.new("ScreenGui")
GHZhub.Name = "GHZhub"
GHZhub.ResetOnSpawn = false
GHZhub.Parent = game:GetService("CoreGui")

-- Frame principal
local Frame = Instance.new("Frame")
Frame.Name = "Frame"
Frame.Size = UDim2.new(0, 206, 0, 144)
Frame.Position = UDim2.new(0.3, 0, 0.3, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = false -- vamos usar nosso sistema arrastável
Frame.Parent = GHZhub

-- Botão Definir ponto
local Definirponto = Instance.new("TextButton")
Definirponto.Name = "Definir ponto"
Definirponto.Size = UDim2.new(0, 180, 0, 40)
Definirponto.Position = UDim2.new(0, 13, 0, 20)
Definirponto.Text = "Definir Ponto"
Definirponto.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Definirponto.TextColor3 = Color3.fromRGB(255, 255, 255)
Definirponto.Parent = Frame

-- Botão Teleportar
local Teleportar = Instance.new("TextButton")
Teleportar.Name = "Teleportar"
Teleportar.Size = UDim2.new(0, 180, 0, 40)
Teleportar.Position = UDim2.new(0, 13, 0, 70)
Teleportar.Text = "Teleportar"
Teleportar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Teleportar.TextColor3 = Color3.fromRGB(255, 255, 255)
Teleportar.Parent = Frame

-- Botão minimizar/maximizar
local ImageButton = Instance.new("TextButton")
ImageButton.Name = "ImageButton"
ImageButton.Size = UDim2.new(0, 30, 0, 30)
ImageButton.Position = UDim2.new(1, -35, 0, 5)
ImageButton.Text = "-"
ImageButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ImageButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ImageButton.Parent = Frame

-- ===================== TELEPORT =====================
local targetPosition = nil
local tweenTime = 1

Definirponto.MouseButton1Click:Connect(function()
	targetPosition = humanoidRootPart.Position
	print("Ponto definido em:", targetPosition)
end)

Teleportar.MouseButton1Click:Connect(function()
	if targetPosition then
		local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
		local tweenGoal = {CFrame = CFrame.new(targetPosition)}
		local tween = TweenService:Create(humanoidRootPart, tweenInfo, tweenGoal)
		tween:Play()
	else
		warn("Defina um ponto primeiro!")
	end
end)

-- ===================== MAXIMIZAR/MINIMIZAR =====================
local minimized = false
ImageButton.MouseButton1Click:Connect(function()
	if minimized then
		Frame.Size = UDim2.new(0, 206, 0, 144)
		ImageButton.Text = "-"
		minimized = false
	else
		Frame.Size = UDim2.new(0, 206, 0, 50)
		ImageButton.Text = "+"
		minimized = true
	end
end)

-- ===================== FRAME ARRASTÁVEL =====================
local dragging = false
local dragInput, mousePos, framePos

local function update(input)
	local delta = input.Position - mousePos
	Frame.Position = UDim2.new(
		0,
		math.clamp(framePos.X.Offset + delta.X, 0, workspace.CurrentCamera.ViewportSize.X - Frame.AbsoluteSize.X),
		0,
		math.clamp(framePos.Y.Offset + delta.Y, 0, workspace.CurrentCamera.ViewportSize.Y - Frame.AbsoluteSize.Y)
	)
end

Frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		mousePos = input.Position
		framePos = Frame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

Frame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)

RunService.RenderStepped:Connect(function()
	if dragging and dragInput then
		update(dragInput)
	end
end)

-- ===================== CHROMA UIStroke =====================
local UIStroke = Instance.new("UIStroke")
UIStroke.Parent = Frame
UIStroke.Thickness = 3
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

local hue = 0
local colorSpeed = 0.5

local renderConnection = RunService.RenderStepped:Connect(function(deltaTime)
	hue = (hue + colorSpeed * deltaTime) % 1
	UIStroke.Color = Color3.fromHSV(hue, 1, 1)
end)

-- Limpeza caso o frame seja destruído
Frame.AncestryChanged:Connect(function()
	if not Frame:IsDescendantOf(game) then
		renderConnection:Disconnect()
	end
end)
